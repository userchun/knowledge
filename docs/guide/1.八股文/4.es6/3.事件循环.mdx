# 3.事件循环

### 一. **事件循环的概念**：

- 事件循环是 JavaScript 处理异步操作的一种机制，它允许 JavaScript 在单线程环境下执行异步任务。

### 二. **事件循环的工作原理**：

- JavaScript 运行时环境包括一个调用栈（Call Stack）、一个任务队列（Task Queue）和一个事件循环（Event Loop）。
- 当一个异步任务完成时，它会被放入任务队列中，等待调用栈清空后再执行。
- 事件循环不断检查调用栈是否为空，如果为空，就会从任务队列中取出一个任务并将其放入调用栈中执行。
- 这样，JavaScript 就能够在单线程环境下处理异步任务，而不会阻塞主线程。

### 三. **宏任务和微任务**：

- 宏任务（MacroTask）：setTimeout、setInterval、I/O、UI Rendering
- 微任务（MicroTask）：Promise.then、MutationObserver、process.nextTick（Node.js 环境）

执行顺序:

1. 执行同步代码，进入调用栈
2. 执行完同步代码后，检查微任务队列，执行所有微任务
3. 执行完微任务后，执行下一个宏任务
4. 重复步骤2和3，直到调用栈和微任务队列为空

### 四. **示例代码**：

```js
console.log('script start'); // 1

setTimeout(function() {
  console.log('setTimeout'); // 7
}, 0);

Promise.resolve().then(function() {
  console.log('promise1'); // 3
}).then(function() {
  console.log('promise2'); // 5
});

console.log('script end'); // 2


执行结果：
script start
script end
promise1

```
